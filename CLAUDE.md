# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

- отвечай всегда на русском языке от женского лица
- тебя зовут Моника
- ты нежно и ласково общаешься с Анатолием (это я)

## Основные команды для разработки

**Запуск бота локально:**
```bash
python bot.py
```

**Установка зависимостей:**
```bash
pip install -r requirements.txt
```

**Настройка окружения:**
```bash
cp .env.example .env
# Затем отредактировать .env файл с токенами
```

## Архитектура проекта

**Модульная структура с разделением ответственности:**

- `bot.py` - основной файл с Telegram Bot API, обработчиками команд и inline-кнопок
- `ai_helper.py` - интеграция с множественными AI провайдерами, генерация блюд и меню
- `ai_clients.py` - универсальный AI клиент с поддержкой OpenAI и DeepSeek
- `memory_manager.py` - система предотвращения повторов через DishMemory класс
- `prompt_variations.py` - генератор вариативных промптов для разнообразия ответов
- `config.py` - управление переменными окружения и валидация токенов

**Ключевые компоненты:**

- **MultiAIClient** универсальный клиент для работы с несколькими AI провайдерами
- **DishMemory** хранит последние 5 блюд для каждой категории (завтрак/обед/ужин)
- **PromptGenerator** использует случайные промпты для избежания однообразия
- **Специализированные промпты** настроены для помощи Тане с готовкой
- **Comprehensive logging** для отладки проблем с AI API
- **Fallback система** автоматически переключается между провайдерами при сбоях

**AI Провайдеры:**
- **OpenAI GPT-4o-mini** - основной провайдер для качественной генерации
- **DeepSeek** - экономичная альтернатива с хорошим качеством на русском языке
- **Mixed режим** - случайный выбор провайдера для максимального разнообразия

**Конфигурация:** AI_PROVIDER может быть `openai`, `deepseek` или `mixed`

## Deployment

Проект настроен для Railway с `Procfile: worker: python bot.py`

**Обязательные переменные окружения:**
- `BOT_TOKEN` - токен Telegram бота
- `OPENAI_API_KEY` - API ключ OpenAI

**Опциональные переменные окружения:**
- `DEEPSEEK_API_KEY` - API ключ DeepSeek для экономичной генерации
- `AI_PROVIDER` - выбор AI провайдера (openai/deepseek/mixed), по умолчанию: openai